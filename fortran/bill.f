*     SEIKYU-SHO NO HAKKO

      INTEGER TENBAN,OLDTB,TANKA,SURYO,SOSU,
     -     GAKU,SHOKEI,GOKEI
      CHARACTER NAMAE(200)*25,HINMEI*20,OLDHM*20,
     -     BAR*1
      DATA BAR/'-'/

      OPEN(10,FILE='NAMAEF.TXT',STATUS='OLD')
 10   READ(10,100,END=20) I,NAMAE(I)
 100  FORMAT(I3,2X,A25)
      GO TO 10
 20   CLOSE(10)

      OPEN(11,FILE='DENPYO.TXT', STATUS='OLD')
      READ(11,110) TENBAN,HINMEI,TANKA,SURYO
 110  FORMAT(I3,1X,A20,1X,I6,1X,I5)

 30   CONTINUE
      OLDTB=TENBAN
      GOKEI=0
      WRITE(6,200) NAMAE(TENBAN),'(',TENBAN,');'
 200  FORMAT(///' ',A,A,I3,A//)

 40   CONTINUE
      OLDHM=HINMEI
      SOSU=0
      SHOKEI=0
 50   CONTINUE
      GAKU=TANKA*SURYO
      WRITE(6,210) HINMEI,TANKA,SURYO,GAKU
 210  FORMAT(' ',6X,A20,2X,I6,1X,I5,1X,I10)
      SOSU=SOSU+SURYO
      SHOKEI=SHOKEI+GAKU

      READ(11,110,END=90) TENBAN,HINMEI,TANKA,SURYO
      IF((HINMEI.NE.OLDHM)
     -     .OR. (TENBAN.NE.OLDTB)) GO TO 60
      HINMEI=' '
      GO TO 50

 60   WRITE(6,220) (BAR,I=1,23),SOSU,SHOKEI
 220  FORMAT(' ',28X,23A1/' ',35X,I5,1X,I10/)
      GOKEI=GOKEI+SHOKEI
      IF(TENBAN.EQ.OLDTB) GO TO 40

      WRITE(6,230)(BAR,I=1,28),'TOTAL',GOKEI
 230  FORMAT(' ',23X,28A1/' ',30X,A5,6X,I10)
      IF(TENBAN.GT.0) GO TO 30

      CLOSE(11)
      STOP

 90   TENBAN=-1000
      GO TO 60
      END
